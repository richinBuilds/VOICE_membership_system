<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VOICE - Join Our Community</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-size: 1.8rem;
            font-weight: bold;
            color: white !important;
            letter-spacing: 2px;
        }

        .navbar-nav .nav-link {
            color: rgba(255,255,255,0.8) !important;
            margin: 0 15px;
            transition: color 0.3s ease;
        }

        .navbar-nav .nav-link:hover {
            color: white !important;
        }

        /* Hero Section */
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 80px 0;
            text-align: center;
        }

        .hero-section h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            animation: slideInDown 0.8s ease-out;
        }

        .hero-section .tagline {
            font-size: 1.5rem;
            margin-bottom: 30px;
            opacity: 0.95;
            animation: slideInUp 0.8s ease-out;
        }

        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
            animation: fadeIn 1s ease-out 0.3s forwards;
            opacity: 0;
        }

        .btn-primary-custom {
            background: white;
            color: #667eea;
            padding: 12px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary-custom:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .btn-secondary-custom {
            background: transparent;
            color: white;
            padding: 12px 40px;
            font-size: 1.1rem;
            font-weight: 600;
            border: 2px solid white;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary-custom:hover {
            background: white;
            color: #667eea;
            transform: translateY(-3px);
        }

        /* Mission Section */
        .mission-section {
            padding: 60px 0;
            background: #f8f9fa;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 40px;
            color: #333;
            position: relative;
            padding-bottom: 20px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }

        .mission-content {
            font-size: 1.2rem;
            line-height: 1.8;
            color: #555;
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        /* Benefits Section */
        .benefits-section {
            padding: 60px 0;
            background: white;
        }

        .benefits-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .benefit-card {
            text-align: center;
            padding: 30px;
            border-radius: 10px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .benefit-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.2);
            background: white;
        }

        .benefit-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 20px;
        }

        .benefit-card h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .benefit-card p {
            color: #666;
            font-size: 0.95rem;
        }

        /* Membership Options Section */
        .membership-section {
            padding: 60px 0;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .membership-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .membership-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .membership-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.3);
        }

        .membership-card.featured {
            border: 3px solid #667eea;
            transform: scale(1.05);
        }

        .membership-card.featured:hover {
            transform: scale(1.05) translateY(-10px);
        }

        .membership-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .membership-card.featured .membership-header {
            position: relative;
        }

        .membership-card.featured .membership-header::before {
            content: '★ POPULAR ★';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            background: #ffc107;
            color: #333;
            padding: 5px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        .membership-name {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .membership-price {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .membership-price .currency {
            font-size: 1.5rem;
            vertical-align: super;
        }

        .membership-period {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .membership-body {
            padding: 30px 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .membership-description {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 20px;
        }

        .membership-features {
            list-style: none;
            margin-bottom: 30px;
            flex-grow: 1;
        }

        .membership-features li {
            padding: 10px 0;
            color: #555;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
        }

        .membership-features li:before {
            content: '✓ ';
            color: #667eea;
            font-weight: bold;
            margin-right: 10px;
        }

        .membership-features li:last-child {
            border-bottom: none;
        }

        .membership-footer {
            padding: 20px;
        }

        .membership-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            text-align: center;
        }

        .membership-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* CTA Section */
        .cta-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 0;
            text-align: center;
        }

        .cta-section h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .cta-section p {
            font-size: 1.1rem;
            margin-bottom: 30px;
            opacity: 0.95;
        }

        /* Sign-In / Sign-Up Modal */
        .modal-overlay {
            display: flex;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease-out;
        }

        .modal-overlay.show {
            background: rgba(0, 0, 0, 0.6);
            opacity: 1;
            pointer-events: auto;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 50px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            position: relative;
            animation: slideUp 0.4s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #999;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px 30px;
            border-radius: 15px 15px 0 0;
            text-align: center;
        }

        .modal-header h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .modal-header p {
            font-size: 0.95rem;
            opacity: 0.9;
            margin: 0;
        }

        .modal-body {
            padding: 30px;
            text-align: center;
            color: #666;
            line-height: 1.6;
        }

        .modal-footer {
            padding: 0 30px 30px;
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 35px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
            color: white;
        }

        .modal-btn-secondary {
            background: transparent;
            color: #667eea;
            padding: 12px 35px;
            border: 2px solid #667eea;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .modal-btn-secondary:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        /* Footer */
        footer {
            background: #1a1a1a;
            color: white;
            text-align: center;
            padding: 30px 0;
            margin-top: 60px;
        }

        /* Animations */
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-section h1 {
                font-size: 2.2rem;
            }

            .hero-section .tagline {
                font-size: 1.1rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .membership-card.featured {
                transform: scale(1);
            }

            .membership-card.featured:hover {
                transform: translateY(-10px);
            }

            .cta-buttons {
                flex-direction: column;
            }

            .btn-primary-custom,
            .btn-secondary-custom {
                width: 100%;
            }
        }
    </style>
</head>
<body th:attrappend="data-user-logged-in=${isUserLoggedIn}" data-user-logged-in="false">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <span class="navbar-brand">VOICE</span>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="#benefits">Benefits</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#membership">Membership</a>
                    </li>
                    <!-- If NOT logged in: Show Sign In link -->
                    <li class="nav-item" th:if="!${isUserLoggedIn}">
                        <a class="nav-link" href="/login">Sign In</a>
                    </li>
                    <!-- If logged in: Show Profile and Logout -->
                    <li class="nav-item dropdown" th:if="${isUserLoggedIn}">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-user-circle"></i> Profile
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end">
                            <li><a class="dropdown-item" href="/profile">My Dashboard</a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <form action="/logout" method="post" style="margin: 0;">
                                    <button type="submit" class="dropdown-item" style="border: none; background: none; cursor: pointer; text-align: left; padding: 0.5rem 1rem;">
                                        Logout
                                    </button>
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container">
            <h1>Welcome to VOICE</h1>
            <p class="tagline" th:text="${tagline}"></p>
            <div class="cta-buttons" th:if="!${isUserLoggedIn}">
                <a href="/register" class="btn-primary-custom">Join Now</a>
                <a href="/login" class="btn-secondary-custom">Sign In</a>
            </div>
            <div class="cta-buttons" th:if="${isUserLoggedIn}">
                <a href="/profile" class="btn-primary-custom">Go to Dashboard</a>
            </div>
        </div>
    </section>

    <!-- Benefits Section -->
    <section class="benefits-section" id="benefits">
        <div class="container">
            <h2 class="section-title">Why Join VOICE?</h2>
            <div class="benefits-grid">
                <div class="benefit-card" th:each="benefit : ${benefits}">
                    <div class="benefit-icon">
                        <i th:class="'fas ' + ${benefit.icon}"></i>
                    </div>
                    <h3 th:text="${benefit.title}"></h3>
                    <p th:text="${benefit.description}"></p>
                </div>
            </div>
            <!-- Detailed Member Benefits List -->
            <div class="mission-content" style="text-align:left; max-width:900px; margin:40px auto 0;">
                <h4>10 Great Reasons to Be a Member</h4>
                <ol style="font-size:1.1rem; line-height:1.7;">
                    <li><b>Connection:</b> You are connected to a larger group banded together to produce positive results for children experiencing hearing loss in our province.</li>
                    <li><b>Annual Educational Conference:</b> The annual Conference provides quality education and networking for those who have experienced hearing loss in their lives, or the lives of others, and you receive a SIGNIFICANT discount by being a member. You can contribute to the content of the conference, participate as a volunteer, or attend to enhance your professional development.</li>
                    <li><b>Public Policy / Advocacy:</b> You can contribute to the strong advocacy program centered on assuring that the voices of those who are experiencing hearing loss are being heard.</li>
                    <li><b>Free Financial & Informational Services:</b> VOICE provides their members with the opportunity to access Financial Aid such as Funds dedicated to helping families provide their children with hearing technology, as well as various scholarships to assist in educational endeavours. VOICE keeps members in touch with each other and current issues through our web site and email updates of emerging issues relevant to hearing loss. You remain informed about hearing loss in our region in a way that saves you time.</li>
                    <li><b>Networking:</b> You have many opportunities to network with like-minded individuals and professionals in our region, building your contacts, sharing ideas, best practices and solutions to enhance your learning, find opportunities to connect, and more. Networking events range from Annual Conferences to workshops, and activities for your children.</li>
                    <li><b>Affiliation:</b> You will have affiliation with a local chapter and dozens of professionals in your region.</li>
                    <li><b>Discounts on Educational Offerings:</b> You receive reduced registration fees at all VOICE events and workshops.</li>
                    <li><b>Leadership Opportunities:</b> You are provided opportunities to learn and practice leadership by becoming an integral part of VOICE whether that be getting involved in your chapter, starting a new chapter, volunteering at events or hosting your own events!</li>
                    <li><b>Recognition:</b> You can be recognized or can recognize your colleagues for their achievements in the hearing loss community, whether that be at VOICE or another affiliated organization.</li>
                    <li><b>Empowerment:</b> You are part of a larger community. You are empowered to get involved in issues that affect your personal and professional communities and your quality of life.</li>
                </ol>
            </div>
        </div>
    </section>

    <!-- Membership Options Section -->
    <section class="membership-section" id="membership">
        <div class="container">
            <h2 class="section-title">Choose Your Membership</h2>
            <div class="membership-grid">
                <div class="membership-card" th:each="membership, itemStat : ${memberships}" 
                     th:classappend="${itemStat.index == 1} ? 'featured' : ''">
                    <div class="membership-header">
                        <div class="membership-name" th:text="${membership.name}"></div>
                        <div th:if="${membership.isFree}" class="membership-price">
                            <span>Free</span>
                        </div>
                        <div th:unless="${membership.isFree}" class="membership-price">
                            <span class="currency">$</span><span th:text="${membership.price}"></span><span class="membership-period">/month</span>
                        </div>
                    </div>
                    <div class="membership-body">
                        <p class="membership-description" th:text="${membership.description}"></p>
                        <ul class="membership-features">
                            <li th:each="feature : ${#strings.arraySplit(membership.features, '\n')}" 
                                th:text="${feature.trim()}"></li>
                        </ul>
                    </div>
                    <div class="membership-footer">
                        <a href="/register" class="membership-btn" th:text="${membership.isFree ? 'Get Started' : 'Subscribe Now'}"></a>
                    </div>
                </div>
            </div>
            <!-- Simple action buttons as requested (no links) -->
            <div class="text-center mt-4">
                <button type="button" class="btn btn-outline-primary px-4 py-2">Paid</button>
                <button type="button" class="btn btn-outline-secondary px-4 py-2 ms-2">Update Membership</button>
            </div>
        </div>
    </section>


    <!-- Footer -->
    <footer>
        <div class="container">
            <p>Copyright 2023 &copy; VOICE for Children who are Deaf and Hard of Hearing. All rights reserved.</p>
        </div>
    </footer>

    <!-- Sign-In / Sign-Up Pop-Up Modal -->
    <div id="signUpModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close" onclick="closeSignUpModal()">&times;</button>
            <div class="modal-header">
                <h2>Join VOICE Today!</h2>
                <p>Empowering families of children who are Deaf and Hard of Hearing</p>
            </div>
            <div class="modal-body">
                <p>Connect with programs, community support, and resources to help children who are Deaf and Hard of Hearing thrive.</p>
            </div>
            <div class="modal-footer">
                <a href="/register" class="modal-btn-primary">Create Account</a>
                <a href="/login" class="modal-btn-secondary">Sign In</a>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        // Sign-In / Sign-Up Pop-Up Feature (7 seconds delay)
        let signUpTimer;
        let isSignedIn = false;

        document.addEventListener('DOMContentLoaded', function() {
            // Try to fetch login status from API first
            fetch('/api/landing-page/data')
                .then(response => response.json())
                .then(data => {
                    if (typeof data.isUserLoggedIn !== 'undefined') {
                        isSignedIn = data.isUserLoggedIn === 'true';
                        console.log('API login status:', isSignedIn);
                    } else {
                        // Fallback to Thymeleaf attribute if API not available
                        const dataAttr = document.body.getAttribute('data-user-logged-in');
                        isSignedIn = dataAttr === 'true';
                        console.log('Fallback login status:', isSignedIn);
                    }
                    if (!isSignedIn) {
                        startSignUpTimer();
                    } else {
                        console.log('User is logged in, timer not started');
                    }
                })
                .catch(err => {
                    // On error, fallback to Thymeleaf attribute
                    const dataAttr = document.body.getAttribute('data-user-logged-in');
                    isSignedIn = dataAttr === 'true';
                    console.log('API error, fallback login status:', isSignedIn);
                    if (!isSignedIn) {
                        startSignUpTimer();
                    }
                });
        });

        function startSignUpTimer() {
            signUpTimer = setTimeout(function() {
                showSignUpModal();
            }, 7000); // 7 seconds
        }

        function showSignUpModal() {
            const modal = document.getElementById('signUpModal');
            if (modal) {
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';
            }
        }

        function closeSignUpModal() {
            const modal = document.getElementById('signUpModal');
            if (modal) {
                modal.classList.remove('show');
                document.body.style.overflow = 'auto';
            }
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('signUpModal');
            if (event.target === modal) {
                closeSignUpModal();
            }
        }

        // Clear timer if user navigates away
        window.addEventListener('beforeunload', function() {
            if (signUpTimer) {
                clearTimeout(signUpTimer);
            }
        });
    </script>
    

</body>
</html>